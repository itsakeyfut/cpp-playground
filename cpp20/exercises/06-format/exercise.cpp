// std::format（フォーマット文字列）の演習
// TODOコメントを埋めて、プログラムを完成させてください。

#include <format>
#include <iostream>
#include <string>
#include <vector>

// ============================================================================
// 演習 2.5.2.1: 基本的な数値フォーマット
// ============================================================================

void exercise_2_5_2_1() {
  std::cout << "=== 演習 2.5.2.1: 基本的な数値フォーマット ===" << std::endl;

  int number = 255;

  // TODO: numberを10進数でフォーマットして出力
  // 期待値: "10進数: 255"

  // TODO: numberを16進数（小文字）でフォーマットして出力
  // ヒント: {:x} を使用
  // 期待値: "16進数: ff"

  // TODO: numberを2進数でフォーマットして出力
  // ヒント: {:b} を使用
  // 期待値: "2進数: 11111111"

  // TODO: numberを16進数（0xプレフィックス付き）でフォーマットして出力
  // ヒント: {:#x} を使用
  // 期待値: "16進数(0x): 0xff"

  double pi = 3.14159265358979;

  // TODO: piを小数点以下2桁でフォーマットして出力
  // ヒント: {:.2f} を使用
  // 期待値: "円周率: 3.14"

  // TODO: piを小数点以下6桁でフォーマットして出力
  // 期待値: "円周率: 3.141593"

  std::cout << std::endl;
}

// ============================================================================
// 演習 2.5.2.2: テーブル形式の出力
// ============================================================================

struct GameScore {
  std::string player_name;
  int score;
  int level;
  double win_rate;
};

void exercise_2_5_2_2() {
  std::cout << "=== 演習 2.5.2.2: テーブル形式の出力 ===" << std::endl;

  std::vector<GameScore> scores = {
      {"Alice", 1250, 15, 0.785},
      {"Bob", 890, 12, 0.642},
      {"Carol", 1450, 18, 0.823},
      {"Dave", 650, 8, 0.571},
  };

  // TODO: ヘッダー行を出力
  // フォーマット: 名前(左寄せ10文字) スコア(右寄せ8文字) レベル(右寄せ6文字)
  // 勝率(右寄せ8文字)
  // ヒント: {:<10} {:>8} {:>6} {:>8}
  // 期待値: "Name       Score   Level Win Rate"

  // TODO: 区切り線を出力（40文字の'-'）
  // ヒント: std::string(40, '-')

  // TODO: 各プレイヤーのデータを整形して出力
  // 名前: 左寄せ10文字
  // スコア: 右寄せ8文字
  // レベル: 右寄せ6文字
  // 勝率: 右寄せ8文字、小数点以下1桁（例: 78.5%）
  // ヒント: {:.1f}% で勝率をパーセント表示

  std::cout << std::endl;
}

// ============================================================================
// 演習 2.5.2.3: カスタム型のフォーマッター（上級）
// ============================================================================

struct Point3D {
  int x, y, z;
};

// TODO: Point3D用のstd::formatter特殊化を実装してください
// フォーマット: "Point3D(x, y, z)" の形式で出力
// ヒント: template <> struct std::formatter<Point3D> { ... };
// ヒント: parse関数とformat関数を実装

// TODO: ここにformatterの実装を書いてください

void exercise_2_5_2_3() {
  std::cout << "=== 演習 2.5.2.3: カスタム型のフォーマッター ===" << std::endl;

  Point3D player_pos{100, 50, 25};
  Point3D enemy_pos{120, 60, 30};

  // TODO: formatterを実装した後、以下のコメントを外してください
  // std::cout << std::format("Player position: {}", player_pos) << std::endl;
  // std::cout << std::format("Enemy position: {}", enemy_pos) << std::endl;

  // TODO: 距離の計算と表示
  // 簡易的な距離（マンハッタン距離）を計算して表示
  // 距離 = |x1-x2| + |y1-y2| + |z1-z2|
  // int distance = ...;
  // std::cout << std::format("Distance: {} units", distance) << std::endl;

  std::cout << std::endl;
}

// ============================================================================
// ボーナス演習: ログフォーマッター
// ============================================================================

void bonus_exercise() {
  std::cout << "=== ボーナス演習: ログフォーマッター ===" << std::endl;

  // TODO: ログメッセージのフォーマット関数を作成
  // 形式: "[レベル] 時刻 - メッセージ"
  // 例: "[INFO ] 12:34:56 - Game started"
  // ヒント: レベルは左寄せ5文字、時刻はHH:MM:SS形式

  // TODO: 以下のログメッセージを整形して出力
  // - レベル: "INFO", 時刻: "12:34:56", メッセージ: "Game started"
  // - レベル: "WARN", 時刻: "12:35:23", メッセージ: "Low memory"
  // - レベル: "ERROR", 時刻: "12:36:45", メッセージ: "Connection lost"

  std::cout << std::endl;
}

// ============================================================================
// メイン関数
// ============================================================================

int main() {
  std::cout << "std::format の演習\n" << std::endl;

  exercise_2_5_2_1();
  exercise_2_5_2_2();
  exercise_2_5_2_3();
  bonus_exercise();

  std::cout << "演習が完了しました！" << std::endl;
  std::cout << "solution.cppと比較して、答え合わせをしましょう。" << std::endl;
  return 0;
}
